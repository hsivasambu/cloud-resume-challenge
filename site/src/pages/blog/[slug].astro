---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const posts = await getCollection("blog");
  return posts
    .filter((p) => !p.data.draft)
    .map((post) => ({ params: { slug: post.slug }, props: { post } }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<BaseLayout title={`${post.data.title} | Harry Sivasambu`} description={post.data.description ?? ""}>
  <a href="/blog" style="display: inline-block; margin-bottom: 12px;">‚Üê Back to Blog</a>

  <article class="card">
    <h1 style="margin: 0 0 6px; font-size: 30px;">{post.data.title}</h1>
    <p style="margin: 0; color: var(--muted);">
      {post.data.date.toISOString().slice(0, 10)}
    </p>

    {post.data.tags?.length ? (
      <div style="margin-top: 10px; display: flex; gap: 8px; flex-wrap: wrap;">
        {post.data.tags.map((t) => (
          <span class="pill">#{t}</span>
        ))}
      </div>
    ) : null}

    <div style="margin-top: 16px;">
      <Content />
    </div>
  </article>
</BaseLayout>
